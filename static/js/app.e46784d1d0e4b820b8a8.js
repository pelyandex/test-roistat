webpackJsonp([1],{"9M+g":function(t,e){},F4DE:function(t,e){},NHnr:function(t,e,n){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=n("7+uW"),a=n("Dd8w"),i=n.n(a),r=n("mvHQ"),s=n.n(r),l=n("BO1k"),c=n.n(l);function d(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!(t instanceof Array)||0===t.length)return[];var e=t.map(function(t){return i()({},t,{node:[],show:t.show||!1})}),n=e.filter(function(t){return null!==t.parentId}),o=e.filter(function(t){return null===t.parentId});return n.forEach(function(t){return function t(e,n){var o=!0,a=!1,i=void 0;try{for(var r,s=c()(e);!(o=(r=s.next()).done);o=!0){var l=r.value;if(l.id===n.parentId)return void l.node.push(n);0!==l.node.length&&t(l.node,n)}}catch(t){a=!0,i=t}finally{try{!o&&s.return&&s.return()}finally{if(a)throw i}}}(o,t)}),o}var u=n("Gu7T"),h=n.n(u),m=n("nwAy"),p=n.n(m);var f={name:"TreeItem",props:["treeItems","items","changeCallback","req","sortDirection"],data:function(){return{localItems:[]}},watch:{treeItems:{immediate:!0,handler:function(){this.localItems=p()(this.treeItems),this.localSort()}},sortDirection:function(){this.localSort()}},methods:{localSort:function(){var t=this.sortDirection,e=t.type,n=t.direction;this.localItems.sort(function(t,o){return function(t,e,n){return n>0?t.localeCompare(e):e.localeCompare(t)}(t[e],o[e],n)})},reShow:function(t){var e=[].concat(h()(this.items));e.find(function(e){return e.id===t.id}).show=!t.show,this.changeCallback(e)},shift:function(t){return{width:"calc(50% - "+this.req+"px)",marginLeft:(this.req||0)+"px",paddingLeft:0!==t.node.length?"20px":"10px"}}}},v={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",t._l(t.localItems,function(e){return n("div",{key:e.id},[n("div",{staticClass:"table-head table-row"},[n("div",{staticClass:"tree-item table-head__item align-left",style:t.shift(e)},[e.node.length>0?n("span",{staticClass:"arrow",on:{click:function(n){return t.reShow(e)}}},[t._v("\n          "+t._s(e.show?"↑":"↓")+"\n        ")]):t._e(),t._v(" "),n("span",{attrs:{title:e.name}},[t._v("\n          "+t._s(e.name)+"\n        ")])]),t._v(" "),n("div",{staticClass:"tree-item table-head__item align-center"},[t._v(t._s(e.phone))])]),t._v(" "),e.node.length>0?n("TreeItem",{directives:[{name:"show",rawName:"v-show",value:e.show,expression:"node.show"}],attrs:{req:t.req+10||10,"tree-items":e.node,"sort-direction":t.sortDirection,items:t.items,"change-callback":t.changeCallback}}):t._e()],1)}),0)},staticRenderFns:[]};var _={props:["showModal","items"],data:function(){return{name:"",phone:"",parent:null,selectOptions:[]}},methods:{addWorker:function(){var t=0===this.items.length?[0]:this.items.map(function(t){return t.id}),e=Math.max.apply(Math,h()(t)),n={name:this.name,phone:this.phone,parentId:this.parent,id:e+1,show:!1,node:[]};this.closeModal(),this.$emit("addPerson",n)},setItems:function(){var t=this.items.map(function(t){return{value:t.id,text:t.name}});t.push({text:"Без ответственного",value:null}),this.selectOptions=t,this.parent=null},clearForm:function(){this.name="",this.phone=""},closeModal:function(){this.clearForm(),this.$emit("update:showModal",!this.showModal)}}},w={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("b-modal",{attrs:{"no-close-on-backdrop":"",centered:"",title:"Добавить сотрудника"},on:{show:t.setItems},scopedSlots:t._u([{key:"modal-header",fn:function(){return[t._v("\n    Добавить сотрудника\n  ")]},proxy:!0},{key:"modal-footer",fn:function(){return[n("b-button",{attrs:{disabled:0===t.name.length||0===t.phone.length,variant:"primary"},on:{click:t.addWorker}},[t._v("\n      Добавить\n    ")]),t._v(" "),n("b-button",{attrs:{variant:"secondary"},on:{click:t.closeModal}},[t._v("\n      Закрыть\n    ")])]},proxy:!0}]),model:{value:t.showModal,callback:function(e){t.showModal=e},expression:"showModal"}},[t._v(" "),n("div",[n("span",[t._v("Имя сотрудника")]),t._v(" "),n("b-input",{model:{value:t.name,callback:function(e){t.name=e},expression:"name"}})],1),t._v(" "),n("div",[n("span",[t._v("Телефон")]),t._v(" "),n("b-input",{attrs:{type:"number"},model:{value:t.phone,callback:function(e){t.phone=e},expression:"phone"}})],1),t._v(" "),n("div",[n("span",[t._v("Отвественное лицо")]),t._v(" "),n("b-form-select",{attrs:{options:t.selectOptions},model:{value:t.parent,callback:function(e){t.parent=e},expression:"parent"}})],1)])},staticRenderFns:[]};var b={components:{TreeItem:n("VU/8")(f,v,!1,function(t){n("NbWB")},"data-v-13831281",null).exports,Modal:n("VU/8")(_,w,!1,function(t){n("Orw4")},null,null).exports},data:function(){return{items:[],treeItems:[],sortDirection:{type:"name",direction:1},showModal:!1}},watch:{items:function(t){this.treeItems=d(t)}},mounted:function(){var t=window.localStorage.getItem("tree-table-test")||"[]";this.items=JSON.parse(t),window.addEventListener("unload",this.setStorage)},beforeDestroy:function(){this.setStorage()},methods:{setStorage:function(){window.localStorage.setItem("tree-table-test",s()(this.items.map(function(t){return i()({},t,{show:!1})}))),window.removeEventListener("unload",this.setStorage)},changeSort:function(t){var e=this.sortDirection.type,n=this.sortDirection.direction,o={type:t};e===t&&(o.direction=n>0?-1:1),this.sortDirection=o},deleteAll:function(){this.items=[]},addPerson:function(t){this.items.push(t)},changeCallback:function(t){this.items=t}}},g={render:function(){var t=this,e=t.$createElement,n=t._self._c||e;return n("div",{staticClass:"main"},[t.treeItems.length>0?n("div",{staticClass:"table"},[n("div",{staticClass:"table-head"},[n("span",{staticClass:"table-head__item pointer align-center",on:{click:function(e){return t.changeSort("name")}}},[t._v("\n        Имя\n      ")]),t._v(" "),n("span",{staticClass:"table-head__item pointer align-center",on:{click:function(e){return t.changeSort("phone")}}},[t._v("\n        Телефон\n      ")])]),t._v(" "),n("TreeItem",{staticClass:"tree-items",attrs:{"tree-items":t.treeItems,items:t.items,"change-callback":t.changeCallback,"sort-direction":t.sortDirection}})],1):n("div",[t._v("\n    Добавьте сотрудников\n  ")]),t._v(" "),n("div",{staticClass:"button-container"},[n("b-button",{staticClass:"button",attrs:{variant:"primary"},on:{click:function(e){t.showModal=!t.showModal}}},[t._v("\n      Добавить\n    ")]),t._v(" "),t.treeItems.length>0?n("b-button",{staticClass:"button",attrs:{variant:"danger"},on:{click:t.deleteAll}},[t._v("\n      Удалить все\n    ")]):t._e()],1),t._v(" "),n("Modal",{attrs:{"show-modal":t.showModal,items:t.items},on:{"update:showModal":function(e){t.showModal=e},"update:show-modal":function(e){t.showModal=e},addPerson:t.addPerson}})],1)},staticRenderFns:[]};var k={name:"App",components:{TreeTable:n("VU/8")(b,g,!1,function(t){n("pHG5")},null,null).exports}},I={render:function(){var t=this.$createElement,e=this._self._c||t;return e("div",{attrs:{id:"app"}},[e("TreeTable")],1)},staticRenderFns:[]};var y=n("VU/8")(k,I,!1,function(t){n("jfoc")},null,null).exports,M=n("Tqaz");n("qb6w"),n("9M+g");o.default.use(M.a);n("F4DE");o.default.config.productionTip=!1,new o.default({el:"#app",components:{App:y},template:"<App/>"})},NbWB:function(t,e){},Orw4:function(t,e){},jfoc:function(t,e){},pHG5:function(t,e){},qb6w:function(t,e){}},["NHnr"]);
//# sourceMappingURL=app.e46784d1d0e4b820b8a8.js.map